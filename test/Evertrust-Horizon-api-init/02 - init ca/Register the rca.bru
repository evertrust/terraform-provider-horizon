meta {
  name: Register the rca
  type: http
  seq: 1
}

post {
  url: {{horizonUrl}}/api/v1/cas
  body: json
  auth: none
}

headers {
  X-API-ID: {{X-API-ID}}
  X-API-KEY: {{X-API-KEY}}
}

body:json {
  {
      "name": "rca",
      "certificate": "-----BEGIN CERTIFICATE-----\nMIIFSDCCAzCgAwIBAgIINcEedU279OUwDQYJKoZIhvcNAQENBQAwQTELMAkGA1UEBhMCRlIxEjAQBgNVBAoTCUV2ZXJUcnVzdDEeMBwGA1UEAxMVRXZlclRydXN0IExhYiBSb290IENBMCAXDTE5MDgzMDA4NTAwMFoYDzIwNTAwODMwMDg1MDAwWjBBMQswCQYDVQQGEwJGUjESMBAGA1UEChMJRXZlclRydXN0MR4wHAYDVQQDExVFdmVyVHJ1c3QgTGFiIFJvb3QgQ0EwggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDFlrgOQetgBlkaqlq4ZFzEZjE+2v6uwne5UxQqoKioxPfj5LuY275sqE44xfaMm0Gn3Sy8BvkBCYT9SFrcPL6e9cqJ1dYKNGSGnuoqnAlB1RD8ROImOZE+2g43t4ZHdLgcRwMk2UwgMIkrXuaK2Seot9TeI9qlm0NENsO1dbvr7kHDx30lrMHd9gGhEWt9e+DfNms4WNUcxaBelydcv8NkTUbfGzzqaEGvqEo6JZhc/PgHR5X5XxAP8y5dVCYXJ+oS8uWuLnXmMxwa3G1hfIRy6pvfr8rQk7ImlnUL78KudQvCBzsTsR0dx3UrMaOHupFATq8cCwcWbHYBYhskKs8Zjx7MD2Wa3pjFW13EO/R5MTv5C3Y31cTiO7Bq7M2m6VtB+9gu2wiONKtW5BV4eMMZ3FBlZ1pS+47sZfSQj7l/JD2UG0zPiQIWxP0/v2HvyNA577tfpEFjTHuUTZZOOqvuS5X8DtVLxGsFnOb/JGEGkBjxEt4be9gp7j+ZhwpvlFLwu2u2ffy1FdMaqbfs4ImD4UKzGIt0n7QOeeF9rZ+IqcLp0rBNXBt65GwNfosIaktemnwGmhTqIxK7IrHwL2oHNOmqkbfTaVFgXgr3p3lCB4nzILykcGFev9A0vqJzt3N3/OX20aZYNgs8Kt1PIX+QAoXyWomyfyZoUOMuPojVmwIDAQABo0IwQDAPBgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBTJ9DXvg/v1nMXvhES6FUoSFBcKtDAOBgNVHQ8BAf8EBAMCAQYwDQYJKoZIhvcNAQENBQADggIBAEjyT5QxFN6cEpVoK3kfA6xDlo/vk2DwQAIx8ys2BLmDcTB9woQx+4ZaQczRW0M+JGDa1glDiiKBQKwisn6Ecp08HnLRjLYjg3FbGi/fUpXL5guCROIAVRNzj66MPWyHowcunyooMKgGLjNgy2fvaYiSxuVYR3IP1d6CzmM/sIUtuGC92ZhsUc2TE4R0ZbrhIJalsu2KWewTBnri3thuUHQb9jXfmV+C4Uw7wA9coMPrcEJFpda5kA+8wiFHa+MOAYD93Q/GxaT09I8i7G8H6NtJWnVSQPj9DZwilLMbXxXNA7UPm2+xnHl5oPb3nAfCrjNVACE8kWvI0JAJ95dvOphWxCaxVdI880QE0s9ahMqZ1R2Y5pXUNUQK+2CqKOHMojj8TZxd5WQ+gFraHWsCW92g0E0US74crjEqPl8BmiKjFjoklampORKPrpgjYMM3HiuyzwPN2a57CjMO41W6zl00mV+lU3ioMIC2VV+Da0pay7H2fgtW8tGKeyt2hzdg/ZMQBie9valBgfQGyy7NBjMuOM8FO40kt5vRzoQgGOerczz3wJHXflAc82XhRInq25svsJDiPAN1HxNV+/OQeJBjuw9b/FWo5bo9Tp4mUAj/6GfYPMHOtDKmEqUXbk9ZHsyBerbmi9t+JziRF6NmLRkW0gBGVME4oInHoxyPBLzQ\n-----END CERTIFICATE-----",
          "trustedForAuthentication": false,
          "trustedForServerAuthentication": false,
          "trustedForClientAuthentication": true,
          "outdatedRevocationStatusPolicy": "revoked",
          "public": false
  }
}

assert {
  res.body: isJson
  res.status: eq 201
  res.body.name: isDefined
}
