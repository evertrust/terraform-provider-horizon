meta {
  name: Register the v2saca
  type: http
  seq: 5
}

post {
  url: {{horizonUrl}}/api/v1/cas
  body: json
  auth: none
}

headers {
  X-API-ID: {{X-API-ID}}
  X-API-KEY: {{X-API-KEY}}
}

body:json {
  {
      "name": "v2saca",
      "certificate":"-----BEGIN CERTIFICATE-----\nMIIFoDCCA4igAwIBAgIUWHX3OWJj79MJpnpGoE8XAGKHikIwDQYJKoZIhvcNAQELBQAwSjEnMCUGA1UEAwweRXZlclRydXN0IExhYiBSb290IENBIFZlbmRvciAyMRIwEAYDVQQKDAlFdmVyVHJ1c3QxCzAJBgNVBAYTAkZSMB4XDTE5MDkxNjIzMzEwOFoXDTM4MDkxMTIzMzEwOFowZTEvMC0GA1UEAwwmRXZlclRydXN0IExhYiBTZXJ2ZXIgQXV0aGVudGljYXRpb24gQ0ExETAPBgNVBAsMCFZlbmRvciAyMRIwEAYDVQQKDAlFdmVyVHJ1c3QxCzAJBgNVBAYTAkZSMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAr8KJ7pc54gekxjEWkgAJ0f6hcACzSGxSHZrtCDnnrLZlCwtPqseO/jiYAbau7I4FZQLH6aaIPQcxSdLJ4l5+FccXIPMP/om3gaXELLXf+Xu466WUliVeHCKLQZKKTvFnFwOmVGaS1HmMU16ytLQwOziiNXwKdYKArNS2qLNUZUEi3ULKnkay/O4pBshBO7E8j3Ap/dVsEn6e29KjOnbTemZba5874OYjiXGUDxShvT3mM9/XjwUI/LRuR1xNbSRM/6nP4uac6Jaek2uqyIgLtZgGXas8QwBCtCnWVYH+moOEr7QmiZCL2IYlPXZPttZr2L3JXKhWgjGwYF5DwuMaahUOswqi6YPKBEkRClr4p8nR4QhMJkZlF/fzhadkvD7teWdsKYAw87ot8hruBQCAfdetsTS2WGPGTOeFd9q8eQBwzY4uom8zMfHUd8J//ge6jc4Ys6RjgMQ7FCruYpq+vfYFlrGvsVi55FhY4ONUxZHX4wB8XYqUHrZy56WjyOJ4kVXji8DMFOXqfw4/E6QG0dvoqAZrPxEbZVMp7mlJddUaEzwi2+Ul2jdT3icecTGUfTevqvP+QZwUTuzL/9NhkUs0Tx8Qp9+LZOF0Zp2h1dERcE4wZc2dOcOy9kuXF3Xco8pl87YFKh1FnEd8Sx4NUzmK0sjoBTRFV2HuvOEmoMsCAwEAAaNjMGEwDwYDVR0TAQH/BAUwAwEB/zAfBgNVHSMEGDAWgBTWEcgWhSeHUfVsaZUTZym85q65VTAdBgNVHQ4EFgQUcgQAshst4zNNUpc/kpj2l+pfPHkwDgYDVR0PAQH/BAQDAgGGMA0GCSqGSIb3DQEBCwUAA4ICAQAS58RK/NyxPKIiybfufZNBUSIYcE4C/XfWYbQcBqnGhr/iwSnfL1Dx4kuceTpt9fxVzEcjAmRbG8PhdEHu4CKpNSI8Ca9QygOSzLBzxKIvs6BzMdaFxa3dL4y8mbzcCol++twjhorLdUZBsFpRYqWO3s2ZrtTujHPy4yxfQjS2nr6BDzp3F7be//sPPgsC70gHiadsyeb7/nAQmooNCkcT0qnjIBYoJY0EzPgkmXl8hx8cKI+KFsdjRgP3TFC9dkaAkImGDtbXbu+hc6EqJzAbDhGoaerFXPLhKNLUPX1mMFDXmYRkaLRppGDtNdildZcorlh9mJCWMtoA8x3GeAZtTkECSqPY49QBMspqzL+7kuAZccaTarHe59N8QygeoUB/H9jYpBPEXxFHPLrOANYzHnNa2q9Bm/0HCXsRC/FFt1HBnWnjLcfIhTFJR+R3grR7NqBvOA4dJmE1MHqTDkG5nkwA6+ysoxHSblUZ5A3EKdZmw40++AnED2+h9orGt13ueQkHbF+59PeAecIHCDYdqdFXPp3Zcnwr4aHtxI81pXey0CiVJ3x3wlJekz1UYDcMgA3Xi+Zg50CtGf1JZBaTZUeMmlbhveAIgb96cv8hAKDE40DYkKPnOjbtofIsBVGm4OmjV+v2No8FNEahhVczXu+W7Jr8SYwGoGOn3R5esA==\n-----END CERTIFICATE-----",
          "crlUrl": "http://crl-lab.evertrust.fr/saca_vendor2.crl",
          "refresh": "5m",
          "trustedForAuthentication": false,
          "trustedForServerAuthentication": true,
          "trustedForClientAuthentication": true,
          "outdatedRevocationStatusPolicy": "revoked",
          "public": false
  }
}

assert {
  res.body: isJson
  res.status: eq 201
  res.body.name: isDefined
}
